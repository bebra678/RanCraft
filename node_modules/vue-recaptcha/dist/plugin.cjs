"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createPlugin = createPlugin;
var _vueDemi = require("vue-demi");
var _context = require("./composables/context.cjs");
var _proxy = require("./composables/proxy.cjs");
var _common = require("./script-manager/common.cjs");
function createPlugin(scriptManagerFactory) {
  return {
    install(app, options) {
      const isReady = (0, _vueDemi.ref)(false);
      async function waitLoaded() {
        await _common.recaptchaLoaded.promise;
        isReady.value = true;
      }
      waitLoaded();
      (0, _common.checkRecaptchaLoad)();
      const opt = (0, _context.normalizeOptions)(options);
      app.provide(_context.RecaptchaContextKey, {
        isReady,
        scriptInjected: false,
        proxy: (0, _proxy.createRecaptchaProxy)(isReady),
        useScriptProvider: scriptManagerFactory(opt.params),
        options: opt
      });
    }
  };
}